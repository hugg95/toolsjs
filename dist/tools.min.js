/*
 toolsjs v1.0.0
 Author: victor.li https://github.com/lncwwn/toolsjs
 License: MIT 
*/
!function(a,b,c){"use strict";var d=a.Ring||{date:{},version:"1.0"};d.inArray=function(a,b){if(!(a instanceof Array))throw new Error("parameter 'arr' must be an valid Array instance");if(a.indexOf)return-1===a.indexOf(b)?!1:!0;for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return!0;return!1},d._typeof=function(a){if(null===a)return"null";if(a===c)return"undefined";var b;return Object.constructor.name?(b=a.constructor.name.toLowerCase(),"number"===b&&isNaN(a)?"NaN":b):(b=Object.prototype.toString.call(a),b.search(/Object/)>-1?"object":b.search(/Array/)>-1?"array":b.search(/String/)>-1?"string":b.search(/Function/)>-1?"function":b.search(/Date/)>-1?"date":b.search(/Number/)>-1?isNaN(a)?"NaN":"number":b.search(/RegExp/)>-1?"regexp":void 0)},d.isPercentage=function(a){var b=/^(\d+|\d+\.\d+)\%$/;return b.exec(a)?!0:!1},d.isNumeric=function(a){var b=/^(\d+|\d+\.\d+)$/;return b.exec(a)?!0:!1},d.isInteger=function(a){var b=/^\d+$/;return b.exec(a)?!0:!1},d.date.dateFormat=function(a,b){if(!moment)throw new Error("function 'dateFormat' needs supports of moment.js");return moment(a).format(b)},d.getKeys=function(a){if(Object.keys)return Object.keys(a);var b=[];for(var c in a)b.push(c);return b},d.sheetParse=function(a,b,c){if(!a||"array"!==this._typeof(a))throw new Error("parameter 'data' must be a valid Array instance");if(!b||"array"!==this._typeof(b))throw new Error("parameter 'column' must be a valid Array instance");if(c&&"function"!=typeof c)throw new Error("parameter 'fn' must be a valid Function instance");for(var d=0,e=a.length,f=b.length,g=[],h=[];e>d;d++){var i=a[d],j={};for(var k in i)this.inArray(b,k)&&(j[k]=i[k]);g.push(j)}for(d=0,e=g.length;e>d;d++){for(var l=g[d],m=[],n=0;f>n;n++){var k=b[n],o=l[k];c&&(o=c(k,o)||o),m.push(o)}h.push(m)}return h},d.array2String=function(a,b,c){for(var d=0,e=a.length,f="";e>d;d++)f+=a[d].join(b),f+=c||"\n";return f},d.findMatch=function(a,b,c){for(var d=0,e=a.length,f=[];e>d;d++){var g=a[d],h={},i=c?"g":"gi",j=new RegExp(g,i);for(h[g]=[];j.exec(b);)h[g].push(j.lastIndex-g.length);f.push(h)}return f},d.throttle=function(a,b,c){var d=null;return function(){clearTimeout(d),d=setTimeout(function(){a.call(c,arguments)},b)}},d.highlightMatch=function(a,b,c){for(var d=ring.findMatch(a,b),e=0,f=d.length,g=[];f>e;e++){var h=d[e];for(var i in h){var j=h[i];if(j&&j.length)for(var k=0,l=j.length;l>k;k++){var m={};m[i]=Number(j[k]),g.push(m)}}}for(f=g.length,e=0;f>e;e++)for(var k=e+1;f>k;k++){var n=g[e],o=g[k];for(var p in n)if(!n.duplicate)for(var q in o)if(!o.duplicate)if(p===q)n[p]===o[q]&&(o.duplicate=!0);else if(p.indexOf(q)>-1)n[p]<=o[q]&&n[p]+p.length>=o[q]&&(o.duplicate=!0);else if(q.indexOf(p)>-1)o[q]<=n[p]&&o[q]+q.length>=n[p]&&(n.duplicate=!0);else{if(n[p]+p.length>o[q]&&n[p]+p.length<o[q]+q.length){var r=p.substr(0,n[p]+p.length-o[q])+q,j=n[p];n={},o={},n[r]=j,g[e]=n,o[r]=j,g[k]=o,g[e].duplicate=!0}if(o[q]+q.length>n[p]&&o[q]+q.length<n[p]+p.length){var r=q.substr(0,o[q]+q.length-n[p])+p,j=o[q];o={},n={},o[r]=j,g[k]=o,n[r]=j,g[e]=n,g[k].duplicate=!0}}}var s=[];for(e=0;f>e;e++)g[e].duplicate||s.push(g[e]);if(f=s.length,s.sort(function(a,b){for(var c in a)for(var d in b)if(a[c]<b[d])return!0;return!1}),c){if("function"!=typeof c)throw new Error("fn is not a valid Function instance");c(s,b)}else for(e=0;f>e;e++)for(var i in s[e]){var t=s[e][i],u=t+i.length;b=b.substr(0,t)+'<span class="red">'+b.substr(t,i.length)+"</span>"+b.substr(u,b.length)}return b},a.Ring=d}(window,window.document);